<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>blockframes documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">blockframes documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content miscellaneous-variables">
                   <div class="content-data">














                   

<ol class="breadcrumb">
  <li>Miscellaneous</li>
  <li>Variables</li>
</ol>

<section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <ul class="index-list">
                        <li>
                            <a href="#abi" title="apps/backend-functions/src/ipHash.ts"><b>abi</b>&nbsp;&nbsp;&nbsp;(apps/.../ipHash.ts)</a>
                        </li>
                        <li>
                            <a href="#admin" title="apps/backend-functions/src/main.ts"><b>admin</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#ADMIN_ACCEPT_ORG_PATH" title="apps/backend-functions/src/assets/mail-templates.ts"><b>ADMIN_ACCEPT_ORG_PATH</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#ADMIN_ACCESS_TO_APP_PATH" title="apps/backend-functions/src/assets/mail-templates.ts"><b>ADMIN_ACCESS_TO_APP_PATH</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#ADMIN_DATA_PATH" title="apps/backend-functions/src/assets/mail-templates.ts"><b>ADMIN_DATA_PATH</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#adminApp" title="apps/backend-functions/src/admin.ts"><b>adminApp</b>&nbsp;&nbsp;&nbsp;(apps/.../admin.ts)</a>
                        </li>
                        <li>
                            <a href="#adminEmail" title="apps/backend-functions/src/environments/environment.ts"><b>adminEmail</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ts)</a>
                        </li>
                        <li>
                            <a href="#adminEmail" title="apps/backend-functions/src/environments/environment.ci.ts"><b>adminEmail</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ci.ts)</a>
                        </li>
                        <li>
                            <a href="#adminEmail" title="apps/backend-functions/src/environments/environment.prod.ts"><b>adminEmail</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.prod.ts)</a>
                        </li>
                        <li>
                            <a href="#adminEmail" title="apps/backend-functions/src/environments/environment.staging.ts"><b>adminEmail</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.staging.ts)</a>
                        </li>
                        <li>
                            <a href="#algolia" title="apps/backend-functions/src/environments/environment.staging.ts"><b>algolia</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.staging.ts)</a>
                        </li>
                        <li>
                            <a href="#algolia" title="apps/backend-functions/src/environments/environment.ts"><b>algolia</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ts)</a>
                        </li>
                        <li>
                            <a href="#algolia" title="apps/backend-functions/src/environments/environment.ci.ts"><b>algolia</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ci.ts)</a>
                        </li>
                        <li>
                            <a href="#algolia" title="apps/backend-functions/src/environments/environment.prod.ts"><b>algolia</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.prod.ts)</a>
                        </li>
                        <li>
                            <a href="#APPS" title="apps/backend-functions/src/admin.ts"><b>APPS</b>&nbsp;&nbsp;&nbsp;(apps/.../admin.ts)</a>
                        </li>
                        <li>
                            <a href="#auth" title="apps/backend-functions/src/internals/firebase.ts"><b>auth</b>&nbsp;&nbsp;&nbsp;(apps/.../firebase.ts)</a>
                        </li>
                        <li>
                            <a href="#backupedCollections" title="apps/backend-functions/src/backup.ts"><b>backupedCollections</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#bold" title="apps/backend-functions/src/internals/pdf.ts"><b>bold</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#center" title="apps/backend-functions/src/internals/pdf.ts"><b>center</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#clear" title="apps/backend-functions/src/backup.ts"><b>clear</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#db" title="apps/backend-functions/src/internals/firebase.ts"><b>db</b>&nbsp;&nbsp;&nbsp;(apps/.../firebase.ts)</a>
                        </li>
                        <li>
                            <a href="#deleteDelivery" title="apps/backend-functions/src/main.ts"><b>deleteDelivery</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#deleteMaterial" title="apps/backend-functions/src/main.ts"><b>deleteMaterial</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#deleteMovie" title="apps/backend-functions/src/main.ts"><b>deleteMovie</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#deleteTemplate" title="apps/backend-functions/src/main.ts"><b>deleteTemplate</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#description" title="apps/backend-functions/src/internals/pdf.ts"><b>description</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#findOrgByName" title="apps/backend-functions/src/users.ts"><b>findOrgByName</b>&nbsp;&nbsp;&nbsp;(apps/.../users.ts)</a>
                        </li>
                        <li>
                            <a href="#findOrgByName" title="apps/backend-functions/src/main.ts"><b>findOrgByName</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#findUserByMail" title="apps/backend-functions/src/main.ts"><b>findUserByMail</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#findUserByMail" title="apps/backend-functions/src/users.ts"><b>findUserByMail</b>&nbsp;&nbsp;&nbsp;(apps/.../users.ts)</a>
                        </li>
                        <li>
                            <a href="#FONTS" title="apps/backend-functions/src/internals/pdf.ts"><b>FONTS</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#freeze" title="apps/backend-functions/src/backup.ts"><b>freeze</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#generateDeliveryPDF" title="apps/backend-functions/src/main.ts"><b>generateDeliveryPDF</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#generateHash" title="apps/backend-functions/src/main.ts"><b>generateHash</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#generatePassword" title="apps/backend-functions/src/users.ts"><b>generatePassword</b>&nbsp;&nbsp;&nbsp;(apps/.../users.ts)</a>
                        </li>
                        <li>
                            <a href="#getBackupBucket" title="apps/backend-functions/src/backup.ts"><b>getBackupBucket</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#getBackupBucketName" title="apps/backend-functions/src/internals/firebase.ts"><b>getBackupBucketName</b>&nbsp;&nbsp;&nbsp;(apps/.../firebase.ts)</a>
                        </li>
                        <li>
                            <a href="#getBackupOutput" title="apps/backend-functions/src/backup.ts"><b>getBackupOutput</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#getOrCreateUserByMail" title="apps/backend-functions/src/main.ts"><b>getOrCreateUserByMail</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#getOrCreateUserByMail" title="apps/backend-functions/src/users.ts"><b>getOrCreateUserByMail</b>&nbsp;&nbsp;&nbsp;(apps/.../users.ts)</a>
                        </li>
                        <li>
                            <a href="#hashFile" title="apps/backend-functions/src/generateHash.ts"><b>hashFile</b>&nbsp;&nbsp;&nbsp;(apps/.../generateHash.ts)</a>
                        </li>
                        <li>
                            <a href="#hashToFirestore" title="apps/backend-functions/src/generateHash.ts"><b>hashToFirestore</b>&nbsp;&nbsp;&nbsp;(apps/.../generateHash.ts)</a>
                        </li>
                        <li>
                            <a href="#header" title="apps/backend-functions/src/internals/pdf.ts"><b>header</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#indexOrganizationsBuilder" title="apps/backend-functions/src/internals/algolia.ts"><b>indexOrganizationsBuilder</b>&nbsp;&nbsp;&nbsp;(apps/.../algolia.ts)</a>
                        </li>
                        <li>
                            <a href="#ipInterface" title="apps/backend-functions/src/ipHash.ts"><b>ipInterface</b>&nbsp;&nbsp;&nbsp;(apps/.../ipHash.ts)</a>
                        </li>
                        <li>
                            <a href="#isRestoring" title="apps/backend-functions/src/backup.ts"><b>isRestoring</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#KEYS_TIMESTAMP" title="apps/backend-functions/src/backup.ts"><b>KEYS_TIMESTAMP</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#mnemonic" title="apps/backend-functions/src/environments/environment.ci.ts"><b>mnemonic</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ci.ts)</a>
                        </li>
                        <li>
                            <a href="#mnemonic" title="apps/backend-functions/src/environments/environment.staging.ts"><b>mnemonic</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.staging.ts)</a>
                        </li>
                        <li>
                            <a href="#mnemonic" title="apps/backend-functions/src/environments/environment.prod.ts"><b>mnemonic</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.prod.ts)</a>
                        </li>
                        <li>
                            <a href="#mnemonic" title="apps/backend-functions/src/environments/environment.ts"><b>mnemonic</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ts)</a>
                        </li>
                        <li>
                            <a href="#mockConfigIfNeeded" title="apps/backend-functions/src/environments/environment.ts"><b>mockConfigIfNeeded</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ts)</a>
                        </li>
                        <li>
                            <a href="#onAccessToApp" title="apps/backend-functions/src/main.ts"><b>onAccessToApp</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onDeliveryStakeholderCreateEvent" title="apps/backend-functions/src/main.ts"><b>onDeliveryStakeholderCreateEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onDeliveryStakeholderDeleteEvent" title="apps/backend-functions/src/main.ts"><b>onDeliveryStakeholderDeleteEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onDeliveryUpdateEvent" title="apps/backend-functions/src/main.ts"><b>onDeliveryUpdateEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onInvitationUpdateEvent" title="apps/backend-functions/src/main.ts"><b>onInvitationUpdateEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onIpHash" title="apps/backend-functions/src/ipHash.ts"><b>onIpHash</b>&nbsp;&nbsp;&nbsp;(apps/.../ipHash.ts)</a>
                        </li>
                        <li>
                            <a href="#onIpHashEvent" title="apps/backend-functions/src/main.ts"><b>onIpHashEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onOrganizationCreateEvent" title="apps/backend-functions/src/main.ts"><b>onOrganizationCreateEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onOrganizationDeleteEvent" title="apps/backend-functions/src/main.ts"><b>onOrganizationDeleteEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onOrganizationUpdateEvent" title="apps/backend-functions/src/main.ts"><b>onOrganizationUpdateEvent</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onUserCreate" title="apps/backend-functions/src/main.ts"><b>onUserCreate</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#onUserCreate" title="apps/backend-functions/src/users.ts"><b>onUserCreate</b>&nbsp;&nbsp;&nbsp;(apps/.../users.ts)</a>
                        </li>
                        <li>
                            <a href="#organizationCreatedTemplate" title="apps/backend-functions/src/assets/mail-templates.ts"><b>organizationCreatedTemplate</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#organizationRequestAccessToAppTemplate" title="apps/backend-functions/src/assets/mail-templates.ts"><b>organizationRequestAccessToAppTemplate</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#PdfPrinter" title="apps/backend-functions/src/internals/pdf.ts"><b>PdfPrinter</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#PLACEHOLDER_LOGO" title="libs/organization/src/lib/+state/organization.firestore.ts"><b>PLACEHOLDER_LOGO</b>&nbsp;&nbsp;&nbsp;(libs/.../organization.firestore.ts)</a>
                        </li>
                        <li>
                            <a href="#RE_IP_UPLOAD" title="apps/backend-functions/src/generateHash.ts"><b>RE_IP_UPLOAD</b>&nbsp;&nbsp;&nbsp;(apps/.../generateHash.ts)</a>
                        </li>
                        <li>
                            <a href="#RELAYER_CONFIG" title="apps/backend-functions/src/main.ts"><b>RELAYER_CONFIG</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#RELAYER_CONFIG" title="apps/backend-functions/src/orgs.ts"><b>RELAYER_CONFIG</b>&nbsp;&nbsp;&nbsp;(apps/.../orgs.ts)</a>
                        </li>
                        <li>
                            <a href="#relayerDeploy" title="apps/backend-functions/src/main.ts"><b>relayerDeploy</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#relayerRegister" title="apps/backend-functions/src/main.ts"><b>relayerRegister</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#relayerSend" title="apps/backend-functions/src/main.ts"><b>relayerSend</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#restore" title="apps/backend-functions/src/backup.ts"><b>restore</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#sendgridAPIKey" title="apps/backend-functions/src/environments/environment.ci.ts"><b>sendgridAPIKey</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ci.ts)</a>
                        </li>
                        <li>
                            <a href="#sendgridAPIKey" title="apps/backend-functions/src/environments/environment.prod.ts"><b>sendgridAPIKey</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.prod.ts)</a>
                        </li>
                        <li>
                            <a href="#sendgridAPIKey" title="apps/backend-functions/src/environments/environment.ts"><b>sendgridAPIKey</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.ts)</a>
                        </li>
                        <li>
                            <a href="#sendgridAPIKey" title="apps/backend-functions/src/environments/environment.staging.ts"><b>sendgridAPIKey</b>&nbsp;&nbsp;&nbsp;(apps/.../environment.staging.ts)</a>
                        </li>
                        <li>
                            <a href="#serverTimestamp" title="apps/backend-functions/src/internals/firebase.ts"><b>serverTimestamp</b>&nbsp;&nbsp;&nbsp;(apps/.../firebase.ts)</a>
                        </li>
                        <li>
                            <a href="#setRestoreFlag" title="apps/backend-functions/src/backup.ts"><b>setRestoreFlag</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#skipWhenRestoring" title="apps/backend-functions/src/backup.ts"><b>skipWhenRestoring</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#STYLE_BOLD" title="apps/backend-functions/src/internals/pdf.ts"><b>STYLE_BOLD</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#STYLE_DESCRIPTION" title="apps/backend-functions/src/internals/pdf.ts"><b>STYLE_DESCRIPTION</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#STYLE_HEADER" title="apps/backend-functions/src/internals/pdf.ts"><b>STYLE_HEADER</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#STYLE_SUBHEADER" title="apps/backend-functions/src/internals/pdf.ts"><b>STYLE_SUBHEADER</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#STYLE_TABLE_MATERIALS" title="apps/backend-functions/src/internals/pdf.ts"><b>STYLE_TABLE_MATERIALS</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#subHeader" title="apps/backend-functions/src/internals/pdf.ts"><b>subHeader</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                        <li>
                            <a href="#testData" title="apps/backend-functions/src/local/testPDFExport.ts"><b>testData</b>&nbsp;&nbsp;&nbsp;(apps/.../testPDFExport.ts)</a>
                        </li>
                        <li>
                            <a href="#THIRTY_SECONDS_IN_MS" title="apps/backend-functions/src/backup.ts"><b>THIRTY_SECONDS_IN_MS</b>&nbsp;&nbsp;&nbsp;(apps/.../backup.ts)</a>
                        </li>
                        <li>
                            <a href="#updateToV2" title="apps/backend-functions/src/main.ts"><b>updateToV2</b>&nbsp;&nbsp;&nbsp;(apps/.../main.ts)</a>
                        </li>
                        <li>
                            <a href="#USER_WELCOME_PATH" title="apps/backend-functions/src/assets/mail-templates.ts"><b>USER_WELCOME_PATH</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#userInviteTemplate" title="apps/backend-functions/src/assets/mail-templates.ts"><b>userInviteTemplate</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#userRequestedToJoinYourOrgTemplate" title="apps/backend-functions/src/assets/mail-templates.ts"><b>userRequestedToJoinYourOrgTemplate</b>&nbsp;&nbsp;&nbsp;(apps/.../mail-templates.ts)</a>
                        </li>
                        <li>
                            <a href="#withStyle" title="apps/backend-functions/src/internals/pdf.ts"><b>withStyle</b>&nbsp;&nbsp;&nbsp;(apps/.../pdf.ts)</a>
                        </li>
                    </ul>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    <h3>apps/backend-functions/src/ipHash.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="abi"></a>
                        <span class="name">
                            <b>
                            abi</b>
                            <a href="#abi"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>[]</code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[
  &#x27;function scriptsOwner(bytes32) public returns(address)&#x27;,
  &#x27;function addIp(bytes32 _hash)&#x27;,
  &#x27;function scriptsFrom(address _owner) public returns (bytes32[])&#x27;,
  &#x27;event Timestamp(bytes32 indexed scriptHash, address indexed owner)&#x27;
]</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="ipInterface"></a>
                        <span class="name">
                            <b>
                            ipInterface</b>
                            <a href="#ipInterface"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>new Interface(abi)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onIpHash"></a>
                        <span class="name">
                            <b>
                            onIpHash</b>
                            <a href="#onIpHash"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(message: Message) &#x3D;&gt; {
  const { json } &#x3D; message;
  const l &#x3D; ipInterface.parseLog(json);
  const txHash &#x3D; json.transactionHash;

  switch (l.name) {
    case &#x27;Timestamp&#x27;: {
      const hash &#x3D; l.values[0];
      // const owner &#x3D; l.values[1];

      return db.runTransaction(async tx &#x3D;&gt; {
        const hashRef &#x3D; db.collection(&#x27;hash&#x27;).doc(hash);

        const x &#x3D; await tx.get(hashRef);

        if (!x.exists) {
          console.error(&#x27;Unknown hash:&#x27;, hash);
          return;
        }

        const { versionID, ipID }: any &#x3D; x.data();

        const versionRef &#x3D; db.collection(&#x27;ip&#x27;).doc(ipID).collection(&#x27;version&#x27;).doc(versionID);

        const y &#x3D; {
          timestamp: {
            txHash
          }
        };

        console.info(&#x27;Updating version:&#x27;, ipID, versionID, &#x27;with:&#x27;, y);
        tx.update(versionRef, y);
      });
    }
    default: {
      console.error(&#x27;Unknown name:&#x27;, l.name, &#x27;for message:&#x27;, json);
    }
  }

  return null;
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/main.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="admin"></a>
                        <span class="name">
                            <b>
                            admin</b>
                            <a href="#admin"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.https
  .onRequest(adminApp)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: REST call to the /admin app</p>
<ul>
<li>Let admin accept organizations:
  When organizations are created they are in status &quot;pending&quot;,
  cascade8 admins will accept the organization with this function.</li>
<li>Let admin give an organization access to applications:
  Organization cannot access applications until they requested it and
  a cascade8 administrator accept their request.</li>
</ul>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="deleteDelivery"></a>
                        <span class="name">
                            <b>
                            deleteDelivery</b>
                            <a href="#deleteDelivery"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentDelete(&#x27;deliveries/{deliveryId}&#x27;, deleteFirestoreDelivery)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="deleteMaterial"></a>
                        <span class="name">
                            <b>
                            deleteMaterial</b>
                            <a href="#deleteMaterial"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentDelete(&#x27;deliveries/{deliveryId}/materials/{materialId}&#x27;, deleteFirestoreMaterial)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="deleteMovie"></a>
                        <span class="name">
                            <b>
                            deleteMovie</b>
                            <a href="#deleteMovie"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentDelete(&#x27;movies/{movieId}&#x27;, deleteFirestoreMovie)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="deleteTemplate"></a>
                        <span class="name">
                            <b>
                            deleteTemplate</b>
                            <a href="#deleteTemplate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentDelete(&#x27;templates/{templateId}&#x27;, deleteFirestoreTemplate)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="findOrgByName"></a>
                        <span class="name">
                            <b>
                            findOrgByName</b>
                            <a href="#findOrgByName"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.https
  .onCall(users.findOrgByName)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: REST call to find a list of organizations by name. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="findUserByMail"></a>
                        <span class="name">
                            <b>
                            findUserByMail</b>
                            <a href="#findUserByMail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.https
  .onCall(users.findUserByMail)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: REST call to find a list of users by email. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="generateDeliveryPDF"></a>
                        <span class="name">
                            <b>
                            generateDeliveryPDF</b>
                            <a href="#generateDeliveryPDF"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.https.onRequest(onGenerateDeliveryPDFRequest)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: REST call to generate a delivery PDF. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="generateHash"></a>
                        <span class="name">
                            <b>
                            generateHash</b>
                            <a href="#generateHash"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.storage
  .object()
  .onFinalize(hashToFirestore)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when user uploads document to firestore.</p>
<p>NOTE: we will need to refactor the function to dispatch
depending on the file path. Or use different storage buckets
(one per app maybe).</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="getOrCreateUserByMail"></a>
                        <span class="name">
                            <b>
                            getOrCreateUserByMail</b>
                            <a href="#getOrCreateUserByMail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.https.onCall(users.getOrCreateUserByMail)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: REST call to get or create a user. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onAccessToApp"></a>
                        <span class="name">
                            <b>
                            onAccessToApp</b>
                            <a href="#onAccessToApp"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentWrite(
  &#x27;app-requests/{orgId}&#x27;,
  onRequestAccessToAppWrite
)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when an organization requests access to apps. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onDeliveryStakeholderCreateEvent"></a>
                        <span class="name">
                            <b>
                            onDeliveryStakeholderCreateEvent</b>
                            <a href="#onDeliveryStakeholderCreateEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentCreate(
  &#x27;deliveries/{deliveryID}/stakeholders/{stakeholerID}&#x27;,
  onDeliveryStakeholderCreate
)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when a stakeholder is added to a delivery. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onDeliveryStakeholderDeleteEvent"></a>
                        <span class="name">
                            <b>
                            onDeliveryStakeholderDeleteEvent</b>
                            <a href="#onDeliveryStakeholderDeleteEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentDelete(
  &#x27;deliveries/{deliveryID}/stakeholders/{stakeholerID}&#x27;,
  onDeliveryStakeholderDelete
)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when a stakeholder is removed from a delivery. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onDeliveryUpdateEvent"></a>
                        <span class="name">
                            <b>
                            onDeliveryUpdateEvent</b>
                            <a href="#onDeliveryUpdateEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentUpdate(&#x27;deliveries/{deliveryID}&#x27;, onDeliveryUpdate)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when signature (<code>orgId</code>) is added to or removed from <code>validated[]</code>. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onInvitationUpdateEvent"></a>
                        <span class="name">
                            <b>
                            onInvitationUpdateEvent</b>
                            <a href="#onInvitationUpdateEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentWrite(
  &#x27;invitations/{invitationID}&#x27;,
  onInvitationWrite
)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when an invitation is updated (e. g. when invitation.status change). </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onIpHashEvent"></a>
                        <span class="name">
                            <b>
                            onIpHashEvent</b>
                            <a href="#onIpHashEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.pubsub.topic(&#x27;eth-events.ipHash&#x27;).onPublish(onIpHash)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when eth-events-server pushes contract events. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onOrganizationCreateEvent"></a>
                        <span class="name">
                            <b>
                            onOrganizationCreateEvent</b>
                            <a href="#onOrganizationCreateEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentCreate(
  &#x27;orgs/{orgID}&#x27;,
  onOrganizationCreate
)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when an organization is created. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onOrganizationDeleteEvent"></a>
                        <span class="name">
                            <b>
                            onOrganizationDeleteEvent</b>
                            <a href="#onOrganizationDeleteEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onDocumentDelete(
  &#x27;orgs/{orgID}&#x27;,
  onOrganizationDelete
)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when an organization is removed. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onOrganizationUpdateEvent"></a>
                        <span class="name">
                            <b>
                            onOrganizationUpdateEvent</b>
                            <a href="#onOrganizationUpdateEvent"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>onOrganizationDocumentUpdate( // using &#x60;onOrganizationDocumentUpdate&#x60; instead of &#x60;onDocument&#x60; for an increase timout of 540s
  &#x27;orgs/{orgID}&#x27;,
  onOrganizationUpdate
)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when an organization is updated. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onUserCreate"></a>
                        <span class="name">
                            <b>
                            onUserCreate</b>
                            <a href="#onUserCreate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.auth
  .user()
  .onCreate(users.onUserCreate)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: when user creates an account.</p>
<p>We create a corresponding document in <code>users/userID</code>.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="RELAYER_CONFIG"></a>
                        <span class="name">
                            <b>
                            RELAYER_CONFIG</b>
                            <a href="#RELAYER_CONFIG"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../interfaces/RelayerConfig.html" target="_self" >RelayerConfig</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  ...relayer,
  mnemonic
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="relayerDeploy"></a>
                        <span class="name">
                            <b>
                            relayerDeploy</b>
                            <a href="#relayerDeploy"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.runWith({timeoutSeconds: 540}).https
  .onCall((data, context) &#x3D;&gt; relayerDeployLogic(data, RELAYER_CONFIG))</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="relayerRegister"></a>
                        <span class="name">
                            <b>
                            relayerRegister</b>
                            <a href="#relayerRegister"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.runWith({timeoutSeconds: 540}).https
  .onCall((data, context) &#x3D;&gt; relayerRegisterENSLogic(data, RELAYER_CONFIG))</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="relayerSend"></a>
                        <span class="name">
                            <b>
                            relayerSend</b>
                            <a href="#relayerSend"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.https
  .onCall((data, context) &#x3D;&gt; relayerSendLogic(data, RELAYER_CONFIG))</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="updateToV2"></a>
                        <span class="name">
                            <b>
                            updateToV2</b>
                            <a href="#updateToV2"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.https
  .onRequest(migrations.updateToV2)</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Trigger: REST call to migrate the database to V2. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/assets/mail-templates.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="ADMIN_ACCEPT_ORG_PATH"></a>
                        <span class="name">
                            <b>
                            ADMIN_ACCEPT_ORG_PATH</b>
                            <a href="#ADMIN_ACCEPT_ORG_PATH"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;/admin/acceptOrganization&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="ADMIN_ACCESS_TO_APP_PATH"></a>
                        <span class="name">
                            <b>
                            ADMIN_ACCESS_TO_APP_PATH</b>
                            <a href="#ADMIN_ACCESS_TO_APP_PATH"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;/admin/allowAccessToApp&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="ADMIN_DATA_PATH"></a>
                        <span class="name">
                            <b>
                            ADMIN_DATA_PATH</b>
                            <a href="#ADMIN_DATA_PATH"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;/admin/data&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="organizationCreatedTemplate"></a>
                        <span class="name">
                            <b>
                            organizationCreatedTemplate</b>
                            <a href="#organizationCreatedTemplate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(orgId: string): string &#x3D;&gt;
  &#x60;
  A new organization was created on the blockframes project,

  Visit ${appUrl}${ADMIN_ACCEPT_ORG_PATH}/${orgId} to enable it.
  &#x60;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="organizationRequestAccessToAppTemplate"></a>
                        <span class="name">
                            <b>
                            organizationRequestAccessToAppTemplate</b>
                            <a href="#organizationRequestAccessToAppTemplate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(orgId: string, appId: string): string &#x3D;&gt;
  &#x60;
  An organization requested access to an app,

  Visit ${appUrl}${ADMIN_ACCESS_TO_APP_PATH}/${orgId}/${appId} to enable it.
  &#x60;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="USER_WELCOME_PATH"></a>
                        <span class="name">
                            <b>
                            USER_WELCOME_PATH</b>
                            <a href="#USER_WELCOME_PATH"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;/auth/welcome&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="userInviteTemplate"></a>
                        <span class="name">
                            <b>
                            userInviteTemplate</b>
                            <a href="#userInviteTemplate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>({ email, password }: { email: string; password: string }) &#x3D;&gt;
  &#x60;
  You&#x27;ve been invited to a project on the Blockframes Platform!

  login: ${email}\n
  password: ${password}\n

  Click on the following link to login to your account and join the project:
  ${appUrl}${USER_WELCOME_PATH}
  &#x60;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="userRequestedToJoinYourOrgTemplate"></a>
                        <span class="name">
                            <b>
                            userRequestedToJoinYourOrgTemplate</b>
                            <a href="#userRequestedToJoinYourOrgTemplate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(userMail: string): string &#x3D;&gt;
  &#x60;
  The user ${userMail} requested to join your app,

  Visit your organization teamwork page to accept them.
  &#x60;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/admin.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="adminApp"></a>
                        <span class="name">
                            <b>
                            adminApp</b>
                            <a href="#adminApp"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>express()</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="APPS"></a>
                        <span class="name">
                            <b>
                            APPS</b>
                            <a href="#APPS"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>[]</code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[&#x27;delivery&#x27;, &#x27;movie-financing&#x27;, &#x27;stories-and-more&#x27;, &#x27;catalog&#x27;]</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/environments/environment.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="adminEmail"></a>
                        <span class="name">
                            <b>
                            adminEmail</b>
                            <a href="#adminEmail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>mockConfigIfNeeded(&#x27;admin&#x27;, &#x27;email&#x27;)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="algolia"></a>
                        <span class="name">
                            <b>
                            algolia</b>
                            <a href="#algolia"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  ...algoliaClient,
  adminKey: mockConfigIfNeeded(&#x27;algolia&#x27;, &#x27;api_key&#x27;)
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="mnemonic"></a>
                        <span class="name">
                            <b>
                            mnemonic</b>
                            <a href="#mnemonic"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>mockConfigIfNeeded(&#x27;relayer&#x27;, &#x27;mnemonic&#x27;)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="mockConfigIfNeeded"></a>
                        <span class="name">
                            <b>
                            mockConfigIfNeeded</b>
                            <a href="#mockConfigIfNeeded"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(...path: string[]): any &#x3D;&gt;
  path.reduce((config: any, field) &#x3D;&gt; (config ? config[field] : undefined), functions.config())</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Helper to work in local / remote dev mode:
in local the function config will be empty and this function will return an undefined value.
Later, when we test the backend functions code, we&#39;ll let dev define env variables
for local testing.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="sendgridAPIKey"></a>
                        <span class="name">
                            <b>
                            sendgridAPIKey</b>
                            <a href="#sendgridAPIKey"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>mockConfigIfNeeded(&#x27;sendgrid&#x27;, &#x27;api_key&#x27;)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/environments/environment.ci.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="adminEmail"></a>
                        <span class="name">
                            <b>
                            adminEmail</b>
                            <a href="#adminEmail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().admin.email</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="algolia"></a>
                        <span class="name">
                            <b>
                            algolia</b>
                            <a href="#algolia"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  ...algoliaClient,
  adminKey: functions.config().algolia.api_key
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="mnemonic"></a>
                        <span class="name">
                            <b>
                            mnemonic</b>
                            <a href="#mnemonic"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().relayer.mnemonic</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="sendgridAPIKey"></a>
                        <span class="name">
                            <b>
                            sendgridAPIKey</b>
                            <a href="#sendgridAPIKey"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().sendgrid.api_key</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/environments/environment.prod.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="adminEmail"></a>
                        <span class="name">
                            <b>
                            adminEmail</b>
                            <a href="#adminEmail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().admin.email</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="algolia"></a>
                        <span class="name">
                            <b>
                            algolia</b>
                            <a href="#algolia"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  ...algoliaClient,
  adminKey: functions.config().algolia.api_key
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="mnemonic"></a>
                        <span class="name">
                            <b>
                            mnemonic</b>
                            <a href="#mnemonic"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().relayer.mnemonic</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="sendgridAPIKey"></a>
                        <span class="name">
                            <b>
                            sendgridAPIKey</b>
                            <a href="#sendgridAPIKey"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().sendgrid.api_key</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/environments/environment.staging.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="adminEmail"></a>
                        <span class="name">
                            <b>
                            adminEmail</b>
                            <a href="#adminEmail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().admin.email</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="algolia"></a>
                        <span class="name">
                            <b>
                            algolia</b>
                            <a href="#algolia"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  ...algoliaClient,
  adminKey: functions.config().algolia.api_key
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="mnemonic"></a>
                        <span class="name">
                            <b>
                            mnemonic</b>
                            <a href="#mnemonic"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().relayer.mnemonic</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="sendgridAPIKey"></a>
                        <span class="name">
                            <b>
                            sendgridAPIKey</b>
                            <a href="#sendgridAPIKey"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>functions.config().sendgrid.api_key</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/internals/firebase.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="auth"></a>
                        <span class="name">
                            <b>
                            auth</b>
                            <a href="#auth"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>admin.auth()</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="db"></a>
                        <span class="name">
                            <b>
                            db</b>
                            <a href="#db"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>admin.firestore()</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="getBackupBucketName"></a>
                        <span class="name">
                            <b>
                            getBackupBucketName</b>
                            <a href="#getBackupBucketName"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(): string &#x3D;&gt; backupBucket</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="serverTimestamp"></a>
                        <span class="name">
                            <b>
                            serverTimestamp</b>
                            <a href="#serverTimestamp"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>admin.firestore.FieldValue.serverTimestamp</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/backup.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="backupedCollections"></a>
                        <span class="name">
                            <b>
                            backupedCollections</b>
                            <a href="#backupedCollections"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (firestore: Firestore): Promise&lt;CollectionReference[]&gt; &#x3D;&gt; {
  const collections: CollectionReference[] &#x3D; await firestore.listCollections();
  return collections
    .filter(x &#x3D;&gt; !x.path.startsWith(&#x27;_restore&#x27;));
}</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Return all collection in the firestore instance provided, skip the &quot;meta&quot; collection
that should not be backup&#39;d or restored.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="clear"></a>
                        <span class="name">
                            <b>
                            clear</b>
                            <a href="#clear"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async () &#x3D;&gt; {
  const processingQueue &#x3D; new Queue();

  // Note: this code is heavily inspired by the backup function,
  // TODO: implement a generalized way to go through all docs &amp; collections
  // and use it in both functions.

  // retrieve all the collections at the root.
  const collections: CollectionReference[] &#x3D; await backupedCollections(db);
  collections.forEach(x &#x3D;&gt; processingQueue.push(x.path));

  while (!processingQueue.isEmpty()) {
    const currentPath: string &#x3D; processingQueue.pop();
    const docs: DocumentReference[] &#x3D; await db.collection(currentPath).listDocuments();

    // keep all docs subcollection to be deleted to,
    // delete every doc content.
    const promises &#x3D; docs.map(async doc &#x3D;&gt; {
      // Adding the current path to the subcollections to backup
      const subCollections &#x3D; await doc.listCollections();
      subCollections.forEach(x &#x3D;&gt; processingQueue.push(x.path));

      // Delete the document
      return doc.delete();
    });

    await Promise.all(promises);
  }

  return true;
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="freeze"></a>
                        <span class="name">
                            <b>
                            freeze</b>
                            <a href="#freeze"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (req: any, resp: any) &#x3D;&gt; {
  // Prep ouput
  const now &#x3D; new Date().toISOString();
  const bucket: Bucket &#x3D; await getBackupBucket();
  const stream &#x3D; await getBackupOutput(bucket, now);

  // Note: we use a Queue to store the collections to backup instead of doing a recursion,
  // this will protect the stack. It will break when the size of keys to backup grows
  // larger than our memory quota (memory is around 500mo &#x3D;&gt; around 50GB of firestore data to backup)
  // We&#x27;ll have to store them in a collection at this point.
  const processingQueue &#x3D; new Queue();

  // retrieve all the collections at the root.
  const collections: CollectionReference[] &#x3D; await backupedCollections(db);
  collections.forEach(x &#x3D;&gt; processingQueue.push(x.path));

  while (!processingQueue.isEmpty()) {
    // Note: we could speed up the code by processing multiple collections at once,
    // we push many promises to a &quot;worker queue&quot; and await them when it reaches a certain size
    // instead of using a while that blocks over every item.

    const currentPath: string &#x3D; processingQueue.pop();
    const q: QuerySnapshot &#x3D; await db.collection(currentPath).get();

    if (q.size &#x3D;&#x3D;&#x3D; 0) {
      // Empty, move on
      continue;
    }

    // Go through each document of the collection for backup
    const promises &#x3D; q.docs.map(async (doc: QueryDocumentSnapshot) &#x3D;&gt; {
      // Store the data
      const docPath: string &#x3D; doc.ref.path;
      const content: any &#x3D; doc.data();
      const stored: StoredDocument &#x3D; { docPath, content };

      stream.write(JSON.stringify(stored));
      stream.write(&#x27;\n&#x27;);

      // Adding the current path to the subcollections to backup
      const subCollections &#x3D; await doc.ref.listCollections();
      subCollections.forEach(x &#x3D;&gt; processingQueue.push(x.path));
    });

    // Wait for this backup to complete
    await Promise.all(promises);
  }

  console.info(&#x27;Done, closing our stream&#x27;);
  await new Promise(resolve &#x3D;&gt; {
    stream.end(resolve);
  });

  console.info(&#x27;Finally&#x27;);
  return resp.status(200).send(&#x27;success&#x27;);
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="getBackupBucket"></a>
                        <span class="name">
                            <b>
                            getBackupBucket</b>
                            <a href="#getBackupBucket"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (): Promise&lt;Bucket&gt; &#x3D;&gt; {
  const bucket: Bucket &#x3D; admin.storage().bucket(getBackupBucketName());
  const exists &#x3D; await bucket.exists();

  // The api returns an array.
  if (!exists[0]) {
    await bucket.create();
  }

  return bucket;
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="getBackupOutput"></a>
                        <span class="name">
                            <b>
                            getBackupOutput</b>
                            <a href="#getBackupOutput"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (bucket: Bucket, name: string): Promise&lt;Writable&gt; &#x3D;&gt; {
  const blob &#x3D; bucket.file(&#x60;${name}.jsonl&#x60;);
  return blob.createWriteStream({ resumable: false });
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="isRestoring"></a>
                        <span class="name">
                            <b>
                            isRestoring</b>
                            <a href="#isRestoring"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async () &#x3D;&gt; {
  const docRestoreMeta &#x3D; await db.collection(&#x27;_restore&#x27;).doc(&#x27;_DOC&#x27;).get();
  if (docRestoreMeta.exists &amp;&amp; docRestoreMeta.data() &amp;&amp; docRestoreMeta.data()!.restoredAt) {
    // @ts-ignore: within this block, we know .data() and &#x60;restoredAt&#x27; are set
    const { restoredAt } &#x3D; docRestoreMeta.data();

    const now &#x3D; admin.firestore.Timestamp.now();

    // If we started the restoration less than twenty seconds ago, we are still in the restore process,
    return restoredAt.toMillis() + THIRTY_SECONDS_IN_MS &gt; now.toMillis();
  }
  return false;
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="KEYS_TIMESTAMP"></a>
                        <span class="name">
                            <b>
                            KEYS_TIMESTAMP</b>
                            <a href="#KEYS_TIMESTAMP"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>sortBy([&#x27;_seconds&#x27;, &#x27;_nanoseconds&#x27;])</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="restore"></a>
                        <span class="name">
                            <b>
                            restore</b>
                            <a href="#restore"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (req: any, resp: any) &#x3D;&gt; {
  // We get the backup file before clearing the db, just in case.
  const bucket &#x3D; await getBackupBucket();
  const files: GFile[] &#x3D; (await bucket.getFiles())[0];
  const sortedFiles: GFile[] &#x3D; sortBy(files, [&#x27;name&#x27;]);

  if (sortedFiles.length &#x3D;&#x3D;&#x3D; 0) {
    console.info(&#x27;nothing to restore, leaving&#x27;);
    return resp.status(200).send(&#x27;nothing-to-restore&#x27;);
  }

  const lastFile: GFile &#x3D; sortedFiles[sortedFiles.length - 1];

  console.info(&#x27;Updating restore flag&#x27;);
  await setRestoreFlag();

  console.info(&#x27;Clearing the database&#x27;);
  await clear();

  console.info(&#x27;restoring file:&#x27;, lastFile.name);
  const stream &#x3D; lastFile.createReadStream();
  const lineReader &#x3D; readline.createInterface({
    input: stream,
    terminal: false
  });

  const promises: Promise&lt;any&gt;[] &#x3D; [];

  const readerDone &#x3D; new Promise(resolve &#x3D;&gt; {
    lineReader.on(&#x27;close&#x27;, resolve);
  });

  stream.on(&#x27;end&#x27;, () &#x3D;&gt; {
    lineReader.close();
  });

  // TODO: make this part scalable too, we&#x27;re going to load the file
  // and create promises &quot;as fast as possible&quot;, we should backpressure the
  // callback somehow to make sure the X previous promises have been completed
  // before adding more. This will protect us from memory overflow (similar
  // to the note in the backup code).
  lineReader.on(&#x27;line&#x27;, line &#x3D;&gt; {
    const stored: StoredDocument &#x3D; JSON.parse(line);
    promises.push(db.doc(stored.docPath).set(reEncodeObject(stored.content)));
  });

  promises.push(readerDone);
  await Promise.all(promises);

  await setRestoreFlag();

  console.info(&#x60;Done processing: ${promises.length - 1} lines loaded&#x60;);
  return resp.status(200).send(&#x27;success&#x27;);
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="setRestoreFlag"></a>
                        <span class="name">
                            <b>
                            setRestoreFlag</b>
                            <a href="#setRestoreFlag"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async () &#x3D;&gt; {
  return db.collection(&#x27;_restore&#x27;).doc(&#x27;_DOC&#x27;).set({ restoredAt: admin.firestore.FieldValue.serverTimestamp() });
}</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Set the restore timestamp to now.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="skipWhenRestoring"></a>
                        <span class="name">
                            <b>
                            skipWhenRestoring</b>
                            <a href="#skipWhenRestoring"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(f: any) &#x3D;&gt; {
  // return a new function that is:
  // the old function + a check that early exits when we are restoring.
  return async (...args: any[]) &#x3D;&gt; {
    // early exit
    if (await isRestoring()) {
      return true;
    }

    return f(...args);
  };
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="THIRTY_SECONDS_IN_MS"></a>
                        <span class="name">
                            <b>
                            THIRTY_SECONDS_IN_MS</b>
                            <a href="#THIRTY_SECONDS_IN_MS"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>30 * 1000</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/internals/pdf.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="bold"></a>
                        <span class="name">
                            <b>
                            bold</b>
                            <a href="#bold"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(text: string) &#x3D;&gt; withStyle(text, STYLE_BOLD)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="center"></a>
                        <span class="name">
                            <b>
                            center</b>
                            <a href="#center"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(content: string | { [k: string]: any }): any &#x3D;&gt; {
  if (typeof content &#x3D;&#x3D;&#x3D; typeof &#x27;string&#x27;) {
    return { text: content, alignment: &#x27;center&#x27; };
  } else {
    // @ts-ignore: TODO: debug this switch
    return { ...content, alignment: &#x27;center&#x27; };
  }
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="description"></a>
                        <span class="name">
                            <b>
                            description</b>
                            <a href="#description"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(text: string) &#x3D;&gt; withStyle(text, STYLE_DESCRIPTION)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="FONTS"></a>
                        <span class="name">
                            <b>
                            FONTS</b>
                            <a href="#FONTS"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  Helvetica: {
    normal: &#x27;Helvetica&#x27;,
    bold: &#x27;Helvetica-Bold&#x27;,
    italics: &#x27;Helvetica-Oblique&#x27;,
    bolditalics: &#x27;Helvetica-BoldOblique&#x27;
  }
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="header"></a>
                        <span class="name">
                            <b>
                            header</b>
                            <a href="#header"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(text: string) &#x3D;&gt; withStyle(text, STYLE_HEADER)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="PdfPrinter"></a>
                        <span class="name">
                            <b>
                            PdfPrinter</b>
                            <a href="#PdfPrinter"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>require(&#x27;pdfmake&#x27;)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="STYLE_BOLD"></a>
                        <span class="name">
                            <b>
                            STYLE_BOLD</b>
                            <a href="#STYLE_BOLD"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;bold&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="STYLE_DESCRIPTION"></a>
                        <span class="name">
                            <b>
                            STYLE_DESCRIPTION</b>
                            <a href="#STYLE_DESCRIPTION"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;description&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="STYLE_HEADER"></a>
                        <span class="name">
                            <b>
                            STYLE_HEADER</b>
                            <a href="#STYLE_HEADER"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;header&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="STYLE_SUBHEADER"></a>
                        <span class="name">
                            <b>
                            STYLE_SUBHEADER</b>
                            <a href="#STYLE_SUBHEADER"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;subheader&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="STYLE_TABLE_MATERIALS"></a>
                        <span class="name">
                            <b>
                            STYLE_TABLE_MATERIALS</b>
                            <a href="#STYLE_TABLE_MATERIALS"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;styleTableMaterials&#x27;</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="subHeader"></a>
                        <span class="name">
                            <b>
                            subHeader</b>
                            <a href="#subHeader"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(text: string) &#x3D;&gt; withStyle(text, STYLE_SUBHEADER)</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="withStyle"></a>
                        <span class="name">
                            <b>
                            withStyle</b>
                            <a href="#withStyle"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(text: string, style: string): any &#x3D;&gt; ({
  text,
  style
})</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/users.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="findOrgByName"></a>
                        <span class="name">
                            <b>
                            findOrgByName</b>
                            <a href="#findOrgByName"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (data: any, context: CallableContext): Promise&lt;OrgProposal[]&gt; &#x3D;&gt; {
  const prefix: string &#x3D; decodeURIComponent(data.prefix);

  // Leave if the prefix is too short (do not search every users in the universe).
  if (prefix.length &lt; 2) {
    return [];
  }

  // String magic to figure out a prefixEnd
  // Say prefix is &#x27;aaa&#x27;. We want to search all strings between &#x27;aaa&#x27; (prefix) and &#x27;aab&#x27; (prefixEnd)
  // this will match: &#x27;aaa&#x27;, &#x27;aaaa&#x27;, &#x27;aaahello&#x27;, &#x27;aaazerty&#x27;, etc.
  const incLast: string &#x3D; String.fromCharCode(prefix.slice(-1).charCodeAt(0) + 1);
  const prefixEnd: string &#x3D; prefix.slice(0, -1) + incLast;

  return db
    .collection(&#x27;orgs&#x27;)
    .where(&#x27;name&#x27;, &#x27;&gt;&#x3D;&#x27;, prefix)
    .where(&#x27;name&#x27;, &#x27;&lt;&#x27;, prefixEnd)
    .get()
    .then(matchingOrgs &#x3D;&gt; {
      // leave if there are too many results.
      if (matchingOrgs.size &gt; 10) {
        return [];
      }

      return matchingOrgs.docs.map(matchingOrg &#x3D;&gt; ({
        id: matchingOrg.id,
        name: matchingOrg.data().name
      }));
    });
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="findUserByMail"></a>
                        <span class="name">
                            <b>
                            findUserByMail</b>
                            <a href="#findUserByMail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (data: any, context: CallableContext): Promise&lt;UserProposal[]&gt; &#x3D;&gt; {
  const prefix: string &#x3D; decodeURIComponent(data.prefix);

  // Leave if the prefix is too short (do not search every users in the universe).
  if (prefix.length &lt; 2) {
    return [];
  }

  // String magic to figure out a prefixEnd
  // Say prefix is &#x27;aaa&#x27;. We want to search all strings between &#x27;aaa&#x27; (prefix) and &#x27;aab&#x27; (prefixEnd)
  // this will match: &#x27;aaa&#x27;, &#x27;aaaa&#x27;, &#x27;aaahello&#x27;, &#x27;aaazerty&#x27;, etc.
  const incLast: string &#x3D; String.fromCharCode(prefix.slice(-1).charCodeAt(0) + 1);
  const prefixEnd: string &#x3D; prefix.slice(0, -1) + incLast;

  return db
    .collection(&#x27;users&#x27;)
    .where(&#x27;email&#x27;, &#x27;&gt;&#x3D;&#x27;, prefix)
    .where(&#x27;email&#x27;, &#x27;&lt;&#x27;, prefixEnd)
    .get()
    .then(query &#x3D;&gt; {
      // leave if there are too many results.
      if (query.size &gt; 10) {
        return [];
      }

      return query.docs.map(doc &#x3D;&gt; ({ uid: doc.id, email: doc.data().email }));
    });
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="generatePassword"></a>
                        <span class="name">
                            <b>
                            generatePassword</b>
                            <a href="#generatePassword"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>() &#x3D;&gt;
  passwordGenerator({
    length: 12,
    numbers: true
  })</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="getOrCreateUserByMail"></a>
                        <span class="name">
                            <b>
                            getOrCreateUserByMail</b>
                            <a href="#getOrCreateUserByMail"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (
  data: any,
  context: CallableContext
): Promise&lt;UserProposal&gt; &#x3D;&gt; {
  const { email } &#x3D; data;

  try {
    const user &#x3D; await auth.getUserByEmail(email);
    return { uid: user.uid, email };
  } catch {
    const password &#x3D; generatePassword();

    // User does not exists, send them an email.
    const user &#x3D; await auth.createUser({
      email,
      password,
      emailVerified: true,
      disabled: false
    });

    await sendMail(userInvite(email, password));

    return { uid: user.uid, email };
  }
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="onUserCreate"></a>
                        <span class="name">
                            <b>
                            onUserCreate</b>
                            <a href="#onUserCreate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(user: UserRecord) &#x3D;&gt; {
  const { email, uid } &#x3D; user;

  const userDocRef &#x3D; db.collection(&#x27;users&#x27;).doc(user.uid);

  // transaction to UPSERT the user doc
  return db.runTransaction(async tx &#x3D;&gt; {
    const userDoc &#x3D; await tx.get(userDocRef);

    if (userDoc.exists) {
      tx.update(userDocRef, { email, uid });
    } else {
      tx.set(userDocRef, { email, uid });
    }
  });
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/generateHash.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="hashFile"></a>
                        <span class="name">
                            <b>
                            hashFile</b>
                            <a href="#hashFile"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (path: string): Promise&lt;string&gt; &#x3D;&gt; {
  const content &#x3D; await readFile(path, &#x27;hex&#x27;);
  return keccak256(&#x27;0x&#x27; + content);
}</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>compute the keccak256 hash of a whole file </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="hashToFirestore"></a>
                        <span class="name">
                            <b>
                            hashToFirestore</b>
                            <a href="#hashToFirestore"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>async (object: ObjectMetadata) &#x3D;&gt; {
  if (!object.name) {
    console.error(&#x27;Unknown object name:&#x27;, object.name);
    return;
  }

  const filePath: string &#x3D; object.name;
  const match &#x3D; filePath.match(RE_IP_UPLOAD);

  if (!match) {
    console.error(&#x27;Unhandled object name:&#x27;, filePath);
    return;
  }

  const ipID: string | undefined &#x3D; match[1];
  const versionID: string | undefined &#x3D; match[2];

  if (!ipID || !versionID) {
    console.error(&#x27;Missing version in filename:&#x27;, ipID, versionID);
    return;
  }

  // Prep local temporary file
  const tempLocalFile &#x3D; tmpNameSync();
  console.info(&#x27;Created temporary filename: &#x27;, tempLocalFile);

  // Download the document into the function
  const bucket &#x3D; admin.storage().bucket(object.bucket);
  const file &#x3D; bucket.file(filePath);
  await file.download({ destination: tempLocalFile });
  console.info(&#x27;The file has been downloaded to&#x27;, tempLocalFile);

  const ipHash: string &#x3D; await hashFile(tempLocalFile);

  const x &#x3D; {
    storage: {
      path: filePath,
      bucket: object.bucket,
      created: admin.firestore.FieldValue.serverTimestamp()
    },
    hash: {
      version: &#x27;keccak256&#x27;,
      value: ipHash,
      created: admin.firestore.FieldValue.serverTimestamp()
    },
    timestamp: {
      txHash: null
    }
  };

  console.info(&#x27;Updating our IP document&#x27;, ipID, versionID, &#x27;with:&#x27;, x);

  return db.runTransaction(async tx &#x3D;&gt; {
    const versionRef &#x3D; db.doc(&#x60;ip/${ipID}/version/${versionID}&#x60;);

    const current &#x3D; await tx.get(versionRef);
    if (!current.exists) {
      tx.set(versionRef, x);
    } else {
      tx.update(versionRef, x);
    }

    const hashRef &#x3D; db.collection(&#x27;hash&#x27;).doc(ipHash);
    tx.set(hashRef, { versionID, ipID });
  });
}</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>add the hash into the firestore along with some metadata </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="RE_IP_UPLOAD"></a>
                        <span class="name">
                            <b>
                            RE_IP_UPLOAD</b>
                            <a href="#RE_IP_UPLOAD"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>/^ip\/(.+)\/version\/(.+)$/</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/internals/algolia.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="indexOrganizationsBuilder"></a>
                        <span class="name">
                            <b>
                            indexOrganizationsBuilder</b>
                            <a href="#indexOrganizationsBuilder"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(adminKey?: string) &#x3D;&gt; {
  const client &#x3D; algoliasearch(algolia.appId, adminKey || algolia.adminKey);
  const INDEX_NAME_ORGANIZATIONS &#x3D; algolia.indexNameOrganizations;
  return client.initIndex(INDEX_NAME_ORGANIZATIONS);
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>libs/organization/src/lib/+state/organization.firestore.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="PLACEHOLDER_LOGO"></a>
                        <span class="name">
                            <b>
                            PLACEHOLDER_LOGO</b>
                            <a href="#PLACEHOLDER_LOGO"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;/assets/logo/organisation_avatar_250.svg&#x27;</code>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Default placeholder logo used when an Organization is created. </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/orgs.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="RELAYER_CONFIG"></a>
                        <span class="name">
                            <b>
                            RELAYER_CONFIG</b>
                            <a href="#RELAYER_CONFIG"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../interfaces/RelayerConfig.html" target="_self" >RelayerConfig</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  ...relayer,
  mnemonic
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>
    <h3>apps/backend-functions/src/local/testPDFExport.ts</h3>
    <section>
    <h3></h3>        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="testData"></a>
                        <span class="name">
                            <b>
                            testData</b>
                            <a href="#testData"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/object" target="_blank" >object</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>{
  txID: {
    id1: &#x27;0x9e91a0b95412093e639189a05a2dbf68e16c3062001e673826616222baffcac8&#x27;,
    id2: &#x27;0x8e91a0b95412093e639189a05a2dbf68e16c3062001e673826616222baffcac8&#x27;,
    id3: &#x27;0x7e91a0b95412093e639189a05a2dbf68e16c3062001e673826616222baffcac8&#x27;
  },
  orgs: {
    id1: createOrganization({
      name: &#x27;John Doe&#x27;,
      officeAddress: &#x27;LogicalPicture&#x27;,
      userIds: [],
      id: &#x27;&#x27;,
      movieIds: [],
      status: OrganizationStatus.accepted
    }),
    id2: createOrganization({
      name: &#x27;Tomme Hardy&#x27;,
      officeAddress: &#x27;20Th Century Fox&#x27;,
      userIds: [],
      id: &#x27;&#x27;,
      movieIds: [],
      status: OrganizationStatus.accepted
    }),
    id3: createOrganization({
      name: &#x27;Francis Munster&#x27;,
      officeAddress: &#x27;Disney&#x27;,
      userIds: [],
      id: &#x27;&#x27;,
      movieIds: [],
      status: OrganizationStatus.accepted
    })
  },
  steps: {
    i36vwU1eVdlNObEafOre: { id: &#x27;&#x27;, name: &#x27;A&#x27;, date: new Date() },
    P8uVlb5CD0i6NU8fegAf: { id: &#x27;&#x27;, name: &#x27;B&#x27;, date: new Date() }
  },
  materials: [
    {
      deliveryIds: [],
      status: MaterialStatus.pending,
      value: &#x27;My Second Material&#x27;,
      category: &#x27;Some Category&#x27;,
      id: &#x27;0DL3qyDacTcsyIQUCU0R&#x27;,
      description: &#x27;My Second Material Description&#x27;,
      stepId: &#x27;i36vwU1eVdlNObEafOre&#x27;
    },
    {
      deliveryIds: [],
      status: MaterialStatus.pending,
      value: &#x27;My Third Material&#x27;,
      category: &#x27;Another Category&#x27;,
      id: &#x27;Ci3RPg5qLLNTo1e5n7L0&#x27;,
      description: &#x27;My Third Material Description&#x27;,
      stepId: &#x27;i36vwU1eVdlNObEafOre&#x27;
    },
    {
      deliveryIds: [],
      status: MaterialStatus.available,
      description: &#x27;Yet Another Material With a Description&#x27;,
      stepId: &#x27;P8uVlb5CD0i6NU8fegAf&#x27;,
      value: &#x27;Yet Another Material&#x27;,
      category: &#x27;Another Category&#x27;,
      id: &#x27;OtTFuS6Lq3MdjfGicU8v&#x27;
    },
    {
      deliveryIds: [],
      status: MaterialStatus.pending,
      description: &#x27;My Material No Step Description&#x27;,
      stepId: &#x27;&#x27;,
      value: &#x27;My Material No Step&#x27;,
      category: &#x27;Another Category&#x27;,
      id: &#x27;byVmOtNzxPNJZv8qs1OX&#x27;
    },
    {
      deliveryIds: [],
      status: MaterialStatus.delivered,
      description: &#x27;My Material Description&#x27;,
      stepId: &#x27;i36vwU1eVdlNObEafOre&#x27;,
      value: &#x27;My Material&#x27;,
      category: &#x27;Some Category&#x27;,
      id: &#x27;jYpavkTXisbfGfQT873I&#x27;
    }
  ]
}</code>
                        </td>
                    </tr>


            </tbody>
        </table>
</section>



                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'miscellaneous-variables';
            var COMPODOC_CURRENT_PAGE_URL = 'variables.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
