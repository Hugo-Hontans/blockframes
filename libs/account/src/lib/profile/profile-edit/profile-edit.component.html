<main>
  <ng-container *ngIf="(user$ | async) as user; else profileLoading">
    <a mat-icon-button routerLink="/layout/account/profile/view" color="primary"><mat-icon>arrow_back</mat-icon></a>
    <form [formGroup]="accountForm" fxLayout="column">
      <table>
        <tbody>
          <tr>
            <td class="key">Email</td>
            <td class="value">{{ user.email }}</td>
          </tr>
          <tr>
            <td class="key">First Name</td>
            <td class="value">
              <mat-form-field>
                <input matInput type="firstName" formControlName="first_name" />
              </mat-form-field>
            </td>
          </tr>
          <tr>
            <td class="key">Last Name</td>
            <td class="value">
              <mat-form-field>
                <input matInput type="lastName" formControlName="last_name" />
              </mat-form-field>
            </td>
          </tr>
          <tr>
            <td class="key">Biography</td>
            <td>
              <mat-form-field>
                <textarea matInput formControlName="biography"></textarea>
              </mat-form-field>
            </td>
          </tr>
          <tr>
            <td class="key">Id</td>
            <td>{{ user.uid }}</td>
          </tr>
        </tbody>
      </table>
    </form>
    <div>
      <button mat-raised-button routerLink="/layout/account/profile/view">Cancel</button>
      <button mat-raised-button color="primary" (click)="updateProfile()">Save</button>
      <button mat-raised-button color="warn" (click)="deleteAccount()">Delete my account</button>
    </div>
  </ng-container>
  <ng-template #profileLoading>
    <div fxLayout="column" fxLayoutAlign="center center">
      <p>Your Profile is loading...</p>
      <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    </div>
  </ng-template>
</main>
