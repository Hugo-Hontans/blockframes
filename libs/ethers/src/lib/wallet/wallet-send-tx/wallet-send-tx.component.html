<main [ngSwitch]="step">
  <ng-container *ngIf="(wallet$ | async) as wallet; else walletLoading">
    <h1>Sending a Transaction !</h1>

    <section *ngSwitchCase="steps.select">
      <h2>Select a key</h2>

      <!-- TODO integrate Max's component -->
      <key-manager-list [ensDomain]="wallet.ensDomain"></key-manager-list>
      <button mat-raised-button color="accent" (click)="handleKeySelection($event)">Select</button>
      <!-- TODO -->

    </section>

    <section *ngSwitchCase="steps.password">
      <h2>Unlock your key</h2>
      <!-- TODO integrate Max's component -->
      <button mat-raised-button color="accent" (click)="setPassword('azerty')">Unlock</button>
      <!-- TODO -->
    </section>

    <section *ngSwitchCase="steps.confirm">

      <ng-container *ngIf="(isDecrypting$ | async); else decrypted">

        <h2>Decrypting...</h2>
        <p>
          We are decrypting your key.
          Your key is extra secured, so decryption will takes some time (20-30sec),
          please do not close or refresh this tab !
        </p>
        <mat-progress-spinner color="accent" mode="indeterminate"></mat-progress-spinner>

      </ng-container>
      <ng-template #decrypted>

        <ng-container *ngIf="(isDeploying$ | async); else isDeployed">

          <h2>Deploying...</h2>
          <p>
            We are building your very own space into the cyber-world !
            This will take some time, but once it's done you will not need this step anymore for future transactions.
          </p>
          <mat-progress-spinner color="accent" mode="indeterminate"></mat-progress-spinner>

        </ng-container>
        <ng-template #isDeployed>

          <h2>Are you sure ?</h2>
          <button mat-raised-button color="accent" (click)="handleConfirmation()">Yes</button>
          <a mat-button routerLink="/layout/o/account/wallet">No</a>

        </ng-template>

      </ng-template>

    </section>

    <section *ngSwitchCase="steps.end">
      
      <ng-container *ngIf="(isPending$ | async); else txMined">

        <h2>Sending...</h2>
        <p>We are sending your transaction trough a multi-dimensional space-time portal...</p>
        <mat-progress-spinner color="accent" mode="indeterminate"></mat-progress-spinner>

      </ng-container>
      <ng-template #txMined>

        <!-- TODO INTEGRATE MAX'S COMPONENT -->
        <h2>Congratulation !</h2>
        <button mat-raised-button color="accent" (click)="handleRedirect()">Ok</button>
        <!-- TODO -->

      </ng-template>

    </section>
    <div *ngIf="(isDecrypting$ | async)">Decrypting</div>
    <div *ngIf="(isDeploying$ | async)">Deploying</div>
    <div *ngIf="(isPending$ | async)">Pending</div>
  </ng-container>
  <ng-template #walletLoading>
    <div class="wallet-loading">
      <p>We are loading your informations...</p>
      <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    </div>
  </ng-template>
  
</main>