<tunnel-page>
  <h1 subtitle>Additional Information</h1>
  <ng-container tunnel-form>
    <section id="release">
      <h3>Release</h3>
      <article *ngFor="let control of originalRelease.controls; let i = index; let last = last">
        <div fxLayout fxLayoutGap="24px">
          <chips-autocomplete [form]="control.get('country')" model="TERRITORIES" placeholder="Type and Select a Country" fxFlex></chips-autocomplete>

          <static-select [control]="control.get('media')" scope="MEDIAS" label="Role" label="Select Release Media" fxFlex></static-select>
        </div>

        <mat-form-field appearance="outline">
          <mat-label>Release Date</mat-label>
          <input matInput [formControl]="control.get('date')" [matDatepicker]="datePicker" placeholder="YYYY/MM/DD">
          <mat-datepicker-toggle matSuffix [for]="datePicker">
            <mat-icon matDatepickerToggleIcon svgIcon="calendar"></mat-icon>
          </mat-datepicker-toggle>
          <mat-datepicker #datePicker></mat-datepicker>
        </mat-form-field>


        <footer fxLayout="column" fxLayoutAlign="center center">
          <button mat-mini-fab color="warn" (click)="originalRelease.removeAt(i)" aria-label="Remove a Release">
            <mat-icon svgIcon="trash"></mat-icon>
          </button>
          <span>Delete a Release</span>
        </footer>
      </article>
      <footer fxLayout="column" fxLayoutAlign="center center">
        <button mat-mini-fab color="primary" (click)="originalRelease.add()" aria-label="Add a Release">
          <mat-icon svgIcon="add"></mat-icon>
        </button>
        <span>Add a Release</span>
      </footer>
    </section>

    <mat-divider></mat-divider>

    <section id="box-office" *ngIf="units$ | async as units">
      <h3>Box Office</h3>
      <article *ngFor="let control of boxOffice.controls; let i = index; let last = last">
        <div fxLayout fxLayoutGap="24px">
          <form-country [form]="control.get('territory')"></form-country>

          <mat-form-field appearance="outline">
            <mat-label>Metrics</mat-label>
            <mat-select [formControl]="control.get('unit')">
              <mat-option *ngFor="let unit of unitBox | keyvalue" [value]="unit.key">
                {{ unit.value }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <mat-form-field appearance="outline">
          <mat-label>Earnings</mat-label>
          <input test-id="earnings" matInput type="number" [formControl]="control.get('value')" min="0">
          <mat-error *ngIf="control.get('value').hasError('min')">
            Only positive values are accepted.
          </mat-error>
          <span *ngIf="units[i] === '$'" matPrefix>{{ units[i] }}&nbsp;</span>
          <span *ngIf="units[i] !== '$'" matSuffix>&nbsp;{{ units[i] }}</span>
        </mat-form-field>
      </article>
    </section>

    <section id="rating">
      <h3>Rating</h3>
      <article *ngFor="let control of rating.controls; let i = index; let last = last">
        <div fxLayout fxLayoutGap="24px">
          <mat-form-field appearance="outline" fxFlex>
            <mat-label>Rating</mat-label>
            <input matInput [formControl]="rating.get('value')" />
            <mat-hint>Please specify your title's rating, if existing.</mat-hint>
          </mat-form-field>

          <chips-autocomplete [form]="control.get('country')" model="TERRITORIES" placeholder="Type and Select a Country" fxFlex></chips-autocomplete>
        </div>
      </article>
    </section>

    <section id="qualifications">
      <h3>Qualifications</h3>
      <mat-button-toggle-group [formControl]="qualifications" multiple name="certifications" aria-label="Certifications">
        <ng-container *ngFor="let certification of certifications">
          <mat-button-toggle [value]="certification.slug" [matTooltip]="certification?.hint" [matTooltipDisabled]="!certification?.hint">
            {{ certification.label }}
          </mat-button-toggle>
        </ng-container>
      </mat-button-toggle-group>
      <p>Select all that apply</p>
    </section >


  </ng-container>
</tunnel-page>
