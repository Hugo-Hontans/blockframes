<tunnel-page>
  <h1 subtitle>Additional Information</h1>
  <ng-container tunnel-form>
    <section id="release">
      <h3>Release</h3>
      <bf-form-table [columns]="releaseColumns" [form]="originalRelease" buttonText="Add a Release">
        <ng-template formView let-form>
          <article [formGroup]="form" fxLayout="column" fxLayoutGap="24px">

            <div fxLayout fxLayoutGap="24px">
              <chips-autocomplete test-id="release-country" [form]="form.get('country')" model="TERRITORIES" placeholder="Type and Select a Country" fxFlex>
                <mat-label>Country</mat-label>
              </chips-autocomplete>

              <static-select test-id="release-media" type="model" [control]="form.get('media')" scope="MEDIAS" fxFlex>
                <mat-label>Release Media</mat-label>
              </static-select>
            </div>

            <mat-form-field appearance="outline">
              <mat-label>Release Date</mat-label>
              <input matInput test-id="release-date" formControlName="date" [matDatepicker]="datePicker" placeholder="YYYY/MM/DD">
              <mat-datepicker-toggle matSuffix [for]="datePicker">
                <mat-icon matDatepickerToggleIcon svgIcon="calendar"></mat-icon>
              </mat-datepicker-toggle>
              <mat-datepicker #datePicker></mat-datepicker>
            </mat-form-field>

          </article>
        </ng-template>
      </bf-form-table>

    </section>

    <mat-divider></mat-divider>

    <section id="box-office" *ngIf="units$ | async as units">
      <h3>Box Office</h3>

      <bf-form-table [columns]="boxOfficeColumns" [form]="boxOffice" buttonText="Add a Box Office">
        <ng-template formView let-form>
          <article [formGroup]="form" fxLayout="column" fxLayoutGap="24px">

            <div fxLayout fxLayoutGap="24px">
              <form-country test-id="boxoffice-territory" [form]="form.get('territory')"></form-country>

              <mat-form-field appearance="outline">
                <mat-label>Metrics</mat-label>
                <mat-select test-id="boxoffice-unit" formControlName="unit">
                  <mat-option *ngFor="let unit of unitBox | keyvalue" [value]="unit.key">
                    {{ unit.value }}
                  </mat-option>
                </mat-select>
                <mat-hint>Please select applying metrics.</mat-hint>
              </mat-form-field>
            </div>

            <mat-form-field appearance="outline">
              <mat-label>Figures</mat-label>
              <input test-id="boxoffice-earnings" matInput type="number" formControlName="value" min="0" placeholder="Figures">
              <mat-error *ngIf="form.get('value').hasError('min')">
                Please enter box office figures.
              </mat-error>
              <mat-error *ngIf="form.get('value').hasError('required')">
                Please enter box office figures.
              </mat-error>
              {{ form.get('value').controls }}
              <span *ngIf="units[form.get('value')] === '$'" matPrefix>{{ units[form.get('value')] }}&nbsp;</span>
              <span *ngIf="units[form.get('value')] !== '$'" matSuffix>&nbsp;{{ units[form.get('value')] }}</span>
            </mat-form-field>

          </article>
        </ng-template>
      </bf-form-table>
    </section>

    <section id="rating">
      <h3>Rating</h3>
      <article *ngFor="let control of rating.controls; let i = index; let last = last">
        <div fxLayout fxLayoutGap="24px">
          <mat-form-field appearance="outline" fxFlex>
            <mat-label>Rating</mat-label>
            <input matInput [formControl]="rating.get('value')" />
            <mat-hint>Please specify your title's rating, if existing.</mat-hint>
          </mat-form-field>

          <chips-autocomplete [form]="control.get('country')" model="TERRITORIES" placeholder="Type and Select a Country" fxFlex>
            <mat-hint>Please specify country applying rating system.</mat-hint>
          </chips-autocomplete>
        </div>
      </article>
    </section>

    <section id="qualifications">
      <h3>Qualifications</h3>
      <mat-button-toggle-group [formControl]="qualifications" multiple name="certifications" aria-label="Certifications">
        <ng-container *ngFor="let certification of certifications">
          <mat-button-toggle [value]="certification.slug" [matTooltip]="certification?.hint" [matTooltipDisabled]="!certification?.hint">
            {{ certification.label }}
          </mat-button-toggle>
        </ng-container>
      </mat-button-toggle-group>
      <p>Select all that apply</p>
    </section >


  </ng-container>
</tunnel-page>
